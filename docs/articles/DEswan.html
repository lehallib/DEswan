<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DEswan vignette • DEswan</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="DEswan vignette">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DEswan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/DEswan.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>DEswan vignette</h1>
                        <h4 class="author">Benoit Lehallier</h4>
            
            <h4 class="date">2019-09-25</h4>
      
      
      <div class="hidden name"><code>DEswan.Rmd</code></div>

    </div>

    
    
<p>This 1st version of the DEswan vignette briefly describes how to use this package to analyze the links between a quantitative trait (qt) and high dimensional datasets such as -omics data. Here we apply DEswan to the data generated by Lehallier et al. (<a href="https://www.biorxiv.org/content/10.1101/751115v1" class="uri">https://www.biorxiv.org/content/10.1101/751115v1</a>).</p>
<div id="install-development-version-from-github" class="section level1">
<h1 class="hasAnchor">
<a href="#install-development-version-from-github" class="anchor"></a>Install development version from GitHub</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># library(devtools)</span>
<span class="co"># devtools::install_github("lehallib/DEswan",build_vignettes = T)</span></code></pre></div>
<div id="data-description" class="section level2">
<h2 class="hasAnchor">
<a href="#data-description" class="anchor"></a>Data description</h2>
<p>This aging proteomic dataset was generated using SOMAscan. Lehallier et al. measured 1305 plasma proteins from 171 individuals ranged from young adults to centenarians from 4 different cohorts.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># devtools::install("../DEswan")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"DEswan"</span>)
<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(agingplasmaproteome[,<span class="dv">1</span>:<span class="dv">5</span>])
<span class="co">#&gt;   Age    Sex Cohort Feature_1 Feature_2</span>
<span class="co">#&gt; 1 107 Female PRIN09     3.249     2.850</span>
<span class="co">#&gt; 2 105   Male PRIN09     3.105     2.801</span>
<span class="co">#&gt; 3 106 Female PRIN09     3.149     2.841</span>
<span class="co">#&gt; 4 106   Male PRIN09     3.205     2.876</span>
<span class="co">#&gt; 5 105   Male PRIN09     3.159     2.961</span>
<span class="co">#&gt; 6 105   Male PRIN09     3.337     2.860</span></code></pre></div>
<p>The first three column are demographics and samples’ characteristics. Columns 4:1308 are levels of plasma proteins in a log10 scale.</p>
<p>Age is the qt of interest and Sex and Cohort are covariates we want to include in the analysis</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># distribution of qt</span>
<span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(agingplasmaproteome[,<span class="dv">1</span>],<span class="dt">main=</span><span class="st">"qt distribution"</span>,<span class="dt">xlab=</span><span class="st">"Age (years)"</span>)

<span class="co"># covariates</span>
<span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(agingplasmaproteome[,<span class="dv">2</span>])
<span class="co">#&gt; </span>
<span class="co">#&gt; Female   Male </span>
<span class="co">#&gt;     87     84</span>
<span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(agingplasmaproteome[,<span class="dv">3</span>])
<span class="co">#&gt; </span>
<span class="co">#&gt;    GEHA  PRIN06  PRIN09 Seattle </span>
<span class="co">#&gt;      26      51      24      70</span></code></pre></div>
<p><img src="DEswan_files/figure-html/unnamed-chunk-3-1.png" width="384"></p>
</div>
<div id="deswan" class="section level2">
<h2 class="hasAnchor">
<a href="#deswan" class="anchor"></a>DEswan</h2>
<p>To run DEswan we call the function DEswan(). DEswan() takes 5 arguments (3 are optional):</p>
<p>⋅⋅* data.df: a data Frame - columns are variables and rows are samples (same order as qt and covariates)</p>
<p>⋅⋅* qt: a Vector - quantitative trait for DE-SWAN (same order as data.df and covariates)</p>
<p>⋅⋅* window.center: an optional Vector - window centers. Default is quantile(qt, probs = seq(.1,.9,.1))</p>
<p>⋅⋅* buckets.size: an optional Numeric - size of each bucket. Default is set to (max(range(qt))-min(range(qt)))/2</p>
<p>⋅⋅* covariates: a data Frame. Columns are variables and rows are samples (same order as qt and covariates)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
x=<span class="kw"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(agingplasmaproteome[,<span class="dv">1</span>],agingplasmaproteome[,-<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>:<span class="dv">3</span>)])
<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(agingplasmaproteome[,<span class="dv">1</span>:<span class="dv">5</span>])
<span class="co">#&gt;   Age    Sex Cohort Feature_1 Feature_2</span>
<span class="co">#&gt; 1 107 Female PRIN09     3.249     2.850</span>
<span class="co">#&gt; 2 105   Male PRIN09     3.105     2.801</span>
<span class="co">#&gt; 3 106 Female PRIN09     3.149     2.841</span>
<span class="co">#&gt; 4 106   Male PRIN09     3.205     2.876</span>
<span class="co">#&gt; 5 105   Male PRIN09     3.159     2.961</span>
<span class="co">#&gt; 6 105   Male PRIN09     3.337     2.860</span>
start_time &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span>()
<span class="co"># res.DEswan=DEswan(data.df = agingplasmaproteome[,-c(1:3)],</span>
res.DEswan=<span class="kw"><a href="../reference/DEswan.html">DEswan</a></span>(<span class="dt">data.df =</span> agingplasmaproteome[,<span class="dv">3</span>+<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(x) %in%<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(x)[<span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(x)&gt;.<span class="dv">5</span>]))],
                  <span class="dt">qt =</span> agingplasmaproteome[,<span class="dv">1</span>],
                  <span class="dt">window.center =</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">35</span>,<span class="dv">95</span>,<span class="dv">10</span>),
                  <span class="dt">buckets.size =</span> <span class="dv">20</span>,
                  <span class="dt">covariates =</span> agingplasmaproteome[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>:<span class="dv">3</span>)])
<span class="co">#&gt; [1] "window.center  1/7"</span>
<span class="co">#&gt; [1] "window.center  2/7"</span>
<span class="co">#&gt; [1] "window.center  3/7"</span>
<span class="co">#&gt; [1] "window.center  4/7"</span>
<span class="co">#&gt; [1] "window.center  5/7"</span>
<span class="co">#&gt; [1] "window.center  6/7"</span>
<span class="co">#&gt; [1] "window.center  7/7"</span>
end_time &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span>()
end_time-start_time
<span class="co">#&gt; Time difference of 5.328683 secs</span></code></pre></div>
<p>The output of is a list of 2 data.frames: p = pvalues of qT and covariates for each variable and each window.center coefficients = coefficients of qT and covariates for each variable and each window.center</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(res.DEswan$p)
<span class="co">#&gt;     variable window.center factor       pvalue</span>
<span class="co">#&gt; 1 Feature_19            35     qt 0.5982000400</span>
<span class="co">#&gt; 2 Feature_19            35    Sex 0.5392278397</span>
<span class="co">#&gt; 3 Feature_19            35 Cohort 0.9942942114</span>
<span class="co">#&gt; 4 Feature_54            35     qt 0.0457508523</span>
<span class="co">#&gt; 5 Feature_54            35    Sex 0.0001776826</span>
<span class="co">#&gt; 6 Feature_54            35 Cohort 0.0331861758</span>
<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(res.DEswan$coeff)
<span class="co">#&gt;                            variable window.center        factor</span>
<span class="co">#&gt; (Intercept)              Feature_19            35   (Intercept)</span>
<span class="co">#&gt; qt.tmp1                  Feature_19            35            qt</span>
<span class="co">#&gt; covariates$SexMale       Feature_19            35       SexMale</span>
<span class="co">#&gt; covariates$CohortSeattle Feature_19            35 CohortSeattle</span>
<span class="co">#&gt; (Intercept)1             Feature_54            35   (Intercept)</span>
<span class="co">#&gt; qt.tmp11                 Feature_54            35            qt</span>
<span class="co">#&gt;                            coefficient</span>
<span class="co">#&gt; (Intercept)               3.6228803069</span>
<span class="co">#&gt; qt.tmp1                  -0.0194542199</span>
<span class="co">#&gt; covariates$SexMale        0.0218608696</span>
<span class="co">#&gt; covariates$CohortSeattle  0.0004792839</span>
<span class="co">#&gt; (Intercept)1              3.6366547315</span>
<span class="co">#&gt; qt.tmp11                  0.0434974425</span></code></pre></div>
</div>
<div id="note-on-computational-time" class="section level2">
<h2 class="hasAnchor">
<a href="#note-on-computational-time" class="anchor"></a>Note on computational time</h2>
<p>Increasing the resolution of DEswan (more values in “window.center” vector) will provide more detailed results but will require additional computational time. Computational time also depends on the number of features included in the analysis.</p>
<p>Next releases of DEswan will focus on decreasing computational time.</p>
</div>
<div id="reshape-deswan-results" class="section level2">
<h2 class="hasAnchor">
<a href="#reshape-deswan-results" class="anchor"></a>Reshape DEswan results</h2>
<p>DEswan outputs are in long format. Reshaping the results to wide format helps the exploration of the statistics produces by DEswan</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res.DEswan.wide.p=<span class="kw"><a href="../reference/reshape.DEswan.html">reshape.DEswan</a></span>(res.DEswan,<span class="dt">parameter =</span> <span class="dv">1</span>,<span class="dt">factor =</span> <span class="st">"qt"</span>)
<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(res.DEswan.wide.p[,<span class="dv">1</span>:<span class="dv">5</span>])
<span class="co">#&gt;       variable        X35        X45        X55          X65</span>
<span class="co">#&gt; 1  Feature_100 0.07590300 0.29734451 0.86476347 2.929219e-04</span>
<span class="co">#&gt; 2 Feature_1032 0.87131724 0.48797672 0.04809311 8.216263e-02</span>
<span class="co">#&gt; 3 Feature_1056 0.44283629 0.47567400 0.05464477 5.982463e-05</span>
<span class="co">#&gt; 4 Feature_1058 0.62735503 0.64697045 0.39293953 5.509108e-02</span>
<span class="co">#&gt; 5 Feature_1062 0.06621829 0.09694809 0.86923229 1.476878e-01</span>
<span class="co">#&gt; 6 Feature_1064 0.93689325 0.87715881 0.41877198 2.094534e-01</span></code></pre></div>
</div>
<div id="pvalues-adjustment" class="section level2">
<h2 class="hasAnchor">
<a href="#pvalues-adjustment" class="anchor"></a>Pvalues adjustment</h2>
<p>Methods for dealing with multiple testing frequently call for adjusting α in some way. The Bonferroni correction is one simple way to take this into account; adjusting the false discovery rate using the Benjamini-Hochberg procedure is a more powerful method.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res.DEswan.wide.q=<span class="kw"><a href="../reference/q.DEswan.html">q.DEswan</a></span>(res.DEswan.wide.p,<span class="dt">method=</span><span class="st">"BH"</span>)
<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(res.DEswan.wide.q[,<span class="dv">1</span>:<span class="dv">5</span>])
<span class="co">#&gt;       variable       X35       X45       X55          X65</span>
<span class="co">#&gt; 1  Feature_100 0.3715252 0.5867818 0.9178181 0.0010896693</span>
<span class="co">#&gt; 2 Feature_1032 0.9568731 0.7439645 0.1177016 0.1076214765</span>
<span class="co">#&gt; 3 Feature_1056 0.7487959 0.7439645 0.1209991 0.0003272759</span>
<span class="co">#&gt; 4 Feature_1058 0.8174135 0.8232951 0.4834008 0.0764697147</span>
<span class="co">#&gt; 5 Feature_1062 0.3421278 0.3467759 0.9178181 0.1716870179</span>
<span class="co">#&gt; 6 Feature_1064 0.9568731 0.8964370 0.4914348 0.2318948642</span></code></pre></div>
</div>
<div id="calculate-and-plot-the-number-of-significant-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#calculate-and-plot-the-number-of-significant-variables" class="anchor"></a>Calculate and plot the number of significant variables</h2>
<p>One simple way to visualize DEswan results is to count the number of significant variables for each window.center tested.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># head(res.DEswan.wide.p[,1:5])</span>
res.DEswan.wide.p.signif=<span class="kw"><a href="../reference/nsignif.DEswan.html">nsignif.DEswan</a></span>(res.DEswan.wide.p)
toPlot=res.DEswan.wide.p.signif[<span class="dv">1</span>:<span class="dv">3</span>,]
x=<span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="st">"X"</span>,<span class="st">""</span>,<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(toPlot)))
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">1</span>, <span class="dt">type =</span> <span class="st">"n"</span>, <span class="dt">xlim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(x,<span class="dt">na.rm=</span>T),<span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(x,<span class="dt">na.rm=</span>T)),<span class="dt">ylim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(toPlot,<span class="dt">na.rm=</span>T)),<span class="dt">ylab=</span><span class="st">"# significant"</span>,<span class="dt">xlab=</span><span class="st">"qt"</span>)
for(i in <span class="dv">1</span>:<span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(toPlot)){
  <span class="kw"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(x,
        toPlot[i,],<span class="dt">type=</span><span class="st">'l'</span>,<span class="dt">lwd=</span>i)
}
<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topleft"</span>,<span class="dt">legend =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"p&lt;"</span>,<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(toPlot),<span class="dt">sep=</span><span class="st">""</span>),<span class="dt">lwd=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))


<span class="co"># head(res.DEswan.wide.q[,1:5])</span>
res.DEswan.wide.q.signif=<span class="kw"><a href="../reference/nsignif.DEswan.html">nsignif.DEswan</a></span>(res.DEswan.wide.q)
toPlot=res.DEswan.wide.q.signif[<span class="dv">1</span>:<span class="dv">3</span>,]
x=<span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="st">"X"</span>,<span class="st">""</span>,<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(toPlot)))
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dv">1</span>, <span class="dt">type =</span> <span class="st">"n"</span>, <span class="dt">xlim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(x,<span class="dt">na.rm=</span>T),<span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(x,<span class="dt">na.rm=</span>T)),<span class="dt">ylim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(toPlot,<span class="dt">na.rm=</span>T)),<span class="dt">ylab=</span><span class="st">"# significant"</span>,<span class="dt">xlab=</span><span class="st">"qt"</span>)
for(i in <span class="dv">1</span>:<span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(toPlot)){
  <span class="kw"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(x,
        toPlot[i,],<span class="dt">type=</span><span class="st">'l'</span>,<span class="dt">lwd=</span>i)
}
<span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topleft"</span>,<span class="dt">legend =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"q&lt;"</span>,<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(toPlot),<span class="dt">sep=</span><span class="st">""</span>),<span class="dt">lwd=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</code></pre></div>
<p><img src="DEswan_files/figure-html/unnamed-chunk-8-1.png" width="576"><img src="DEswan_files/figure-html/unnamed-chunk-8-2.png" width="576"></p>
</div>
<div id="heatmap-of-changes-during-aging" class="section level2">
<h2 class="hasAnchor">
<a href="#heatmap-of-changes-during-aging" class="anchor"></a>Heatmap of changes during aging</h2>
<p>The best way to identify when and how the features are changing in the qt space is to generate a heatmap of the signed effects.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">

res.DEswan.wide.coeff=<span class="kw"><a href="../reference/reshape.DEswan.html">reshape.DEswan</a></span>(res.DEswan,<span class="dt">parameter =</span> <span class="dv">2</span>,<span class="dt">factor =</span> <span class="st">"qt"</span>)
toHeatmap=<span class="kw"><a href="https://rdrr.io/r/base/sign.html">sign</a></span>(res.DEswan.wide.coeff[,-<span class="dv">1</span>])*-<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(res.DEswan.wide.p[,-<span class="dv">1</span>])
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(toHeatmap)&lt;-res.DEswan.wide.coeff$variable

pairs.breaks &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(-<span class="dv">3</span>, <span class="dv">3</span>, <span class="dt">by=</span><span class="fl">0.01</span>)
mycol &lt;-<span class="st"> </span>gplots::<span class="kw">colorpanel</span>(<span class="dt">n=</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(pairs.breaks)-<span class="dv">1</span>,<span class="dt">low=</span><span class="st">"cyan"</span>,<span class="dt">mid=</span><span class="st">"black"</span>,<span class="dt">high=</span><span class="st">"yellow"</span>)

<span class="co"># display the colorbar</span>
<span class="co"># image(z = matrix(1:100, ncol = 1),col = mycol,xaxt = "n",yaxt = "n")</span>

gplots::<span class="kw">heatmap.2</span>(<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(toHeatmap),
                       <span class="dt">cexRow=</span>.<span class="dv">1</span>,<span class="dt">cexCol=</span>.<span class="dv">7</span>,
                       <span class="dt">trace=</span><span class="st">"none"</span>,
                       <span class="dt">dendrogram=</span><span class="st">"row"</span>,
                       <span class="dt">breaks=</span>pairs.breaks, 
                       <span class="dt">col=</span>mycol, 
                       <span class="dt">Rowv=</span>T,<span class="dt">key=</span>F,
                       <span class="dt">Colv=</span>F,
                       <span class="dt">lhei=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.2</span>,<span class="dv">10</span>),
                       <span class="dt">lwid=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">2</span>,<span class="dv">3</span>)
)</code></pre></div>
<p><img src="DEswan_files/figure-html/unnamed-chunk-9-1.png" width="480"></p>
</div>
<div id="covariates-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#covariates-analysis" class="anchor"></a>Covariates analysis</h2>
<p>Similar analysis can be generated for each covariates. Here we show how sex affect the plasma proteome during aging</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">

res.DEswan.wide.p.covar1=<span class="kw"><a href="../reference/reshape.DEswan.html">reshape.DEswan</a></span>(res.DEswan,<span class="dt">parameter =</span> <span class="dv">1</span>,<span class="dt">factor =</span> <span class="st">"Sex"</span>)
res.DEswan.wide.coeff.covar1=<span class="kw"><a href="../reference/reshape.DEswan.html">reshape.DEswan</a></span>(res.DEswan,<span class="dt">parameter =</span> <span class="dv">2</span>,<span class="dt">factor =</span> <span class="st">"SexMale"</span>)

toHeatmap=<span class="kw"><a href="https://rdrr.io/r/base/sign.html">sign</a></span>(res.DEswan.wide.coeff[,-<span class="dv">1</span>])*-<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(res.DEswan.wide.p[,-<span class="dv">1</span>])
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(toHeatmap)&lt;-res.DEswan.wide.coeff$variable

pairs.breaks &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(-<span class="dv">3</span>, <span class="dv">3</span>, <span class="dt">by=</span><span class="fl">0.01</span>)
mycol &lt;-<span class="st"> </span>gplots::<span class="kw">colorpanel</span>(<span class="dt">n=</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(pairs.breaks)-<span class="dv">1</span>,<span class="dt">low=</span><span class="st">"cyan"</span>,<span class="dt">mid=</span><span class="st">"black"</span>,<span class="dt">high=</span><span class="st">"yellow"</span>)

<span class="co"># display the colorbar</span>
<span class="co"># image(z = matrix(1:100, ncol = 1),col = mycol,xaxt = "n",yaxt = "n")</span>

gplots::<span class="kw">heatmap.2</span>(<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(toHeatmap),
                       <span class="dt">cexRow=</span>.<span class="dv">1</span>,<span class="dt">cexCol=</span>.<span class="dv">7</span>,
                       <span class="dt">trace=</span><span class="st">"none"</span>,
                       <span class="dt">dendrogram=</span><span class="st">"both"</span>,
                       <span class="dt">breaks=</span>pairs.breaks, 
                       <span class="dt">col=</span>mycol, 
                       <span class="dt">Rowv=</span>T,<span class="dt">key=</span>F,
                       <span class="dt">Colv=</span>F,
                       <span class="dt">lhei=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.2</span>,<span class="dv">10</span>),
                       <span class="dt">lwid=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">2</span>,<span class="dv">3</span>)
)
<span class="co">#&gt; Warning in gplots::heatmap.2(as.matrix(toHeatmap), cexRow = 0.1, cexCol</span>
<span class="co">#&gt; = 0.7, : Discrepancy: Colv is FALSE, while dendrogram is `both'. Omitting</span>
<span class="co">#&gt; column dendogram.</span></code></pre></div>
<p><img src="DEswan_files/figure-html/unnamed-chunk-10-1.png" width="480"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#install-development-version-from-github">Install development version from GitHub</a><ul class="nav nav-pills nav-stacked">
<li><a href="#data-description">Data description</a></li>
      <li><a href="#deswan">DEswan</a></li>
      <li><a href="#note-on-computational-time">Note on computational time</a></li>
      <li><a href="#reshape-deswan-results">Reshape DEswan results</a></li>
      <li><a href="#pvalues-adjustment">Pvalues adjustment</a></li>
      <li><a href="#calculate-and-plot-the-number-of-significant-variables">Calculate and plot the number of significant variables</a></li>
      <li><a href="#heatmap-of-changes-during-aging">Heatmap of changes during aging</a></li>
      <li><a href="#covariates-analysis">Covariates analysis</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Benoit Lehallier.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
